// SPDX-FileCopyrightText: 2021 Brent Rubell for Adafruit Industries
// SPDX-License-Identifier: MIT
syntax = "proto3";

package wippersnapper.i2c.v1;
import "nanopb/nanopb.proto";

/**
* I2CInitRequest represents a request to
* initialize an I2C Component.
*/
message I2CInitRequest {
  int32  i2c_pin_scl     = 1; /** The desired I2C SCL pin. */
  int32  i2c_pin_sda     = 2; /** The desired I2C SDA pin. */
  uint32 i2c_frequency   = 3; /** The desired I2C SCL frequency, in Hz. Default is 100000Hz. */
  int32  i2c_port_number = 4; /** The I2C port number. */
}

/**
* I2CInitResponse represents a response to I2CInitRequest
*/
message I2CInitResponse {
  bool is_initialized = 1; /** True if the I2C port has been initialized successfully, False otherwise. */
}

/**
* I2CSetFrequency represents a request to change the
* I2C clock speed to a desired frequency, in Hz.
*/
message I2CSetFrequency {
  uint32 frequency = 1; /** The desired I2C SCL frequency, in Hz. */
  int32 bus_id     = 2; /** An optional I2C bus identifier, if multiple exist. */
}

/**
* I2CScanRequest represents the parameters required to perform
* an I2C component's scan function.
*/
message I2CScanRequest {
  repeated uint32 address = 1 [packed=true, (nanopb).max_count = 6]; /** The 7-bit I2C address for the device stored by IO. */
  int32  i2c_port_number  = 2; /** The desired I2C port to scan. */
}

/**
* I2CScanResponse represents the response of an I2C component which finished executing an I2CScanRequest.
*/
message I2CScanResponse {
  uint32 address_found = 1; /** The 7-bit I2C address of the device on the bus, -1 if not found. */
}

/**
* I2CDeviceInitRequest is a wrapper message containing
* an i2c-device-specific initialization request.
*/
message I2CDeviceInitRequest {
    AHTInitRequest aht_init       = 1;
    DPS310InitRequest dps310_init = 2;
}

/**
* I2CDeviceInitResponse represents if an i2c device
* is successfully initialized by the client.
*/
message I2CDeviceInitResponse {
    bool is_success = 1; /** True if i2c device initialized successfully, false otherwise. */
}

// Device-specific
/**
* AHTInitRequest represents the request to initialize
* an AHTX0 temperature/humidity sensor.
*/
message AHTInitRequest {
  bool enable_temperature = 1; /** True if AHTX0 expects to init. the temperature data object, False otherwise. */
  bool enable_humidity    = 2; /** True if AHTX0 expects to init. the humidity data object, False otherwise. */
  float period            = 3; /** Specifies the time between measurements, in seconds. */
  uint32 address          = 4; /** The 7-bit I2C address of the device on the bus. */
}

/**
* AHTDeinitRequest represents the request to de-initialize
* an AHTX0 temperature/humidity sensor.
*/
message AHTDeinitRequest {
  bool disable_temperature = 1; /** True if AHTX0 expects to de-init. the temperature data object, False otherwise. */
  bool disable_humidity    = 2; /** True if AHTX0 expects to de-init. the humidity data object, False otherwise. */
}

/**
* DPS310 represents the request to initialize
* a DPS310 Precision Barometric Pressure and Altitude Sensor
* NOTE: This RPC also implements the following calls, in addition to begin():
* dps.configurePressure(DPS310_64HZ, DPS310_64SAMPLES);
* dps.configureTemperature(DPS310_64HZ, DPS310_64SAMPLES);
*/
message DPS310InitRequest {
  bool enable_temperature = 1; /** True if DPS310 expects to init. the temperature data object, False otherwise. */
  bool enable_pressure    = 2; /** True if DPS310 expects to init. the pressure data object, False otherwise. */
  float period            = 3; /** Specifies the time between measurements, in seconds. */
  uint32 address          = 4; /** The 7-bit I2C address of the device on the bus. */
}

/**
* SHT4X represents the request to initialize
* a Sensirion SHT40 Temperature & Humidity Sensor
*/
message SHT4XInitRequest {
  bool enable_temperature      = 1; /** True if SHT4X expects to init. the temperature data object, False otherwise. */
  bool enable_humidity         = 2; /** True if SHT4X expects to init. the humidity data object, False otherwise. */
  float period                 = 4; /** Specifies the time between measurements, in seconds. */
  SHT4XHEATERMODE heater_mode  = 5; /** Heater mode. */
  SHT4XPRECISION precision     = 6; /** SHT4X reading precision. */
  uint32 address               = 7; /** The 7-bit I2C address of the device on the bus. */

  /** SHT4X Precision Mode */
  enum SHT4XPRECISION {
    SHT4XPRECISION_UNSPECIFIED = 0;
    SHT4XPRECISION_HIGH        = 1;
    SHT4XPRECISION_MED         = 2;
    SHT4XPRECISION_LOW         = 3;
  }

  /** SHT4X Heater Mode */
  enum SHT4XHEATERMODE {
    SHT4XHEATERMODE_UNSPECIFIED       = 0;
    SHT4XHEATERMODE_NO_HEATER         = 1;
    SHT4XHEATERMODE_HIGH_HEATER_1S    = 2;
    SHT4XHEATERMODE_HIGH_HEATER_100MS = 3;
    SHT4XHEATERMODE_MED_HEATER_1S     = 4;
    SHT4XHEATERMODE_MED_HEATER_100MS  = 5;
    SHT4XHEATERMODE_LOW_HEATER_1S     = 6;
    SHT4XHEATERMODE_LOW_HEATER_100MS  = 7;
  }
}


// Non-Unified API Sensors //

/**
* SCD30InitRequest represents the request to initialize
* a SCD30 CO2 Temperature and Humidity Sensor.
*/
message SCD30InitRequest {
  bool enable_temperature    = 1; /** True if SCD30 expects to init. the temperature data object, False otherwise. */
  bool enable_rel_humidity   = 2; /** True if SCD30 expects to init. the relative humidity data object, False otherwise. */
  bool enable_c02            = 3; /** True if SCD30 expects to init. the CO2 data object, False otherwise. */
  float period               = 4; /** Specifies the time between measurements, in seconds. */
  float measurement_interval = 5; /** Set the amount of time between measurements, in seconds. Must be from 2-1800 seconds. Defaults to 2 seconds. */
  uint32 address             = 6; /** The 7-bit I2C address of the device on the bus. */
}


/**
* SCD30InitResponse represents the response from each
* property of a SCD30 object after a read() event.
*/
message SCD30ReadEvent {
    float c_o2              = 1; /** The most recent CO2 reading */
    float temperature       = 2; /** The most recent temperature reading */
    float relative_humidity = 3; /** The most recent relative humidity reading */
}

/**
* BH1750InitRequest represents the request to initialize
* a BH1750 Ambient Light Sensor.
*/
message BH1750InitRequest {
  bool enable_lux = 1; /** True if BH1750 expects to init. the lux data object, False otherwise. Defaults to True. */
  float period    = 2; /** Specifies the time between measurements, in seconds. */
  uint32 address  = 3; /** The 7-bit I2C address of the device on the bus. */
}

/**
* BH1750ReadEvent represents the response from each
* property of a BH1750 object after a `getLux()` event.
*/
message BH1750ReadEvent {
    float lux              = 1; /** The most recent lux value. */
}

/** Adafruit Unified Sensor Library Messages. */

/**
* SensorType allows us determine what types of units the sensor uses, etc.
*/
enum SensorType {
  SENSOR_TYPE_UNSPECIFIED         = 0;
  SENSOR_TYPE_ACCELEROMETER       = 1;
  SENSOR_TYPE_MAGNETIC_FIELD      = 2;
  SENSOR_TYPE_ORIENTATION         = 3;
  SENSOR_TYPE_GYROSCOPE           = 4;
  SENSOR_TYPE_LIGHT               = 5;
  SENSOR_TYPE_PRESSURE            = 6;
  SENSOR_TYPE_PROXIMITY           = 8;
  SENSOR_TYPE_GRAVITY             = 9;
  SENSOR_TYPE_LINEAR_ACCELERATION = 10;
  SENSOR_TYPE_ROTATION_VECTOR     = 11;
  SENSOR_TYPE_RELATIVE_HUMIDITY   = 12;
  SENSOR_TYPE_AMBIENT_TEMPERATURE = 13;
  SENSOR_TYPE_VOLTAGE             = 15;
  SENSOR_TYPE_CURRENT             = 16;
  SENSOR_TYPE_COLOR               = 17;
}

/**
* SensorDetails is used to describe basic information about a specific sensor.
*/
message SensorDetails {
  string name      = 1; /** The sensor name or ID, up to a maximum of twelve characters (ex. "MPL115A2"). */
  int32 version    = 2; /** The version of the sensor HW and the driver to allow us to differentiate versions of the board or driver. */
  int32 id         = 3; /** A unique sensor identifier that is used to differentiate this specific sensor instance from any others that are present on the system or in the sensor network */
  SensorType type  = 4; /** The sensor type, based on SensorType */
  float max_value  = 5; /** The maximum value that this sensor can return (in the appropriate SI unit) */
  float min_value  = 6; /** The minimum value that this sensor can return (in the appropriate SI unit) */
  float resolution = 7; /** The smallest difference between two values that this sensor can report (in the appropriate SI unit) */
  int32 min_delay  = 8; /** The minimum delay in microseconds between two sensor events, or '0' if there is no constant sensor rate */
}

/**
* SensorEvent  is used to return sensor data from any sensor supported by the abstraction layer,
* using standard SI units and scales.
*/
message SensorEvent {
  int32 version   = 1; /** Contain 'sizeof(sensors_event_t)' to identify which version of the API we're using in case this changes in the future */
  int32 sensor_id = 2; /** A unique sensor identifier that is used to differentiate this specific sensor instance from any others that are present on the system or in the sensor network */
  SensorType type = 3; /** The sensor type, based on SensorType */
  int32 timestamp = 4; /** Time in milliseconds when the sensor value was read */
  oneof event_data {
    float temperature       = 5;
    float distance          = 6;
    float light             = 7;
    float pressure          = 8;
    float relative_humidity = 9;
    float current           = 10;
    float voltage           = 11;
  }
}