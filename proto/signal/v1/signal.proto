syntax = "proto3";

package signal.v1;

/* Signal is a device command or response
   transmitted by an Adafruit IO feed.
   Feed name: devices/ID/signals 
*/
message Signal {
    /* BlinkaConnect command type */
    enum CmdType {
      CMD_TYPE_UNSPECIFIED = 0; // Unspecified/invalid command name
      CMD_TYPE_GET         = 1; // Gets data from a device OR IO
      CMD_TYPE_SET         = 2; // Sets data to a device OR IO
    }

    /* BlinkaConnect command types */
    enum CmdName {
      CMD_NAME_UNSPECIFIED        = 0; // Unspecified/invalid command name
      CMD_NAME_VERSION            = 1; // BlinkaConnect version
      CMD_NAME_LOCATION           = 2; // Device location
      CMD_NAME_BATTERY            = 3; // Device battery level
      CMD_NAME_LIST_PINS_ANALOG   = 4; // List all analog pins
      CMD_NAME_LIST_PINS_DIGITAL  = 5; // List all digital pins
      CMD_NAME_PIN_VALUE          = 6; // Pin value
      CMD_NAME_PIN_MODE           = 7; // Pin mode
      // TODO: Add more commands here
    }

    /* Standard command message */
    message Command {
      CmdType type  = 1; // Command type
      CmdName name  = 2; // Command name
    }
    Command cmd = 1; // One command per signal

    /* PinCommand Message
    *  Uses standard command message
    *  plus additional information about
    *  the pin */
    message PinCommand {
      Command command     = 1;
      Direction direction = 2;
      int64 pin           = 3;
      Mode mode           = 4;
      string value        = 5; // UTF-8 String

      enum Mode {
        MODE_UNSPECIFIED = 0;
        MODE_ANALOG = 1;
        MODE_DIGITAL = 2;
        MODE_PWM = 3;
      }

      enum Direction {
        DIRECTION_UNSPECIFIED = 0;
        DIRECTION_INPUT = 1;
        DIRECTION_OUTPUT = 2;
      }

    }
    PinCommand pin_cmd = 2;
}